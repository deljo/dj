!function(){"use strict";var t="0.0.3",i=function(t){this.Avocado=!1,this.el=!1,this.status=!1,this.targetMatch=[],this.options={id:!1,clickTrack:!1,content:!1},this.onClick=this.onClick.bind(this),this.initialize(t)};i.prototype.initialize=function(t){this.options=this._extend(this.options,t),this.Avocado=this.options.Avocado;var i=this.options.id;return!(!this.Avocado||!i)&&(this.getEl(),!!this.el&&(this.render(),this.setupTracking(),this))},i.prototype._extend=function(t){t=t||{},"object"!=typeof t&&(t={});for(var i=1;i<arguments.length;i++)if(arguments[i])for(var e in arguments[i])arguments[i].hasOwnProperty(e)&&(t[e]=arguments[i][e]);return t},i.prototype._hasTargetKey=function(t){var i=this,e={},n=i.Avocado.targeting[t],r=i.options.targeting[t];return n&&n.values?(n=n.values,"string"==typeof r&&(r=r.toLowerCase().split(",")),r.forEach(function(r){if("url"===t){if(n[0].indexOf(r)<=-1)return}else if(n.indexOf(r)<=-1)return;e[t]=r,i.targetMatch.push(e)}),i.targetMatch):status},i.prototype.createEl=function(t){var i,e,n;return!!t&&(!!(i=document.querySelector(t))&&(n=document.createElement("div"),n.setAttribute("data-avocado-unit-id",this.options.id),e=i.parentNode,e.lastChild===i?e.appendChild(n):e.insertBefore(n,i.nextSibling),n))},i.prototype.getEl=function(){return this.options.$el&&"string"==typeof this.options.$el&&(this.el=this.createEl(this.options.$el)),this.options.id&&"string"==typeof this.options.id&&(this.el=document.querySelector('[data-avocado-unit-id="'+this.options.id+'"]')),this.el},i.prototype.isActive=function(){return this.el&&this.options.id},i.prototype.isTargeted=function(){if(!this.Avocado)return!1;var t=!1,i=this.options.targeting;if(!i)return t=!0;for(var e in i)this._hasTargetKey(e);return this.targetMatch.length===Object.keys(this.options.targeting).length&&(t=!0),t},i.prototype.getContentLinks=function(){var t=/href="([^\'\"]+)/g,i=this.options.content,e=i.match(t);return e?e.map(function(t){return t.replace('href="',"")}):[]},i.prototype.canRender=function(){var t=this.getContentLinks(),i=this.Avocado.links,e=this.el;if(this.status=this.isTargeted(),!e)return!1;if(this.Avocado.linkPreferred&&this.Avocado.hasLinks())return!1;if(this.status){var n=!0;return i.length&&t.length?(n=i.filter(function(i){return t.indexOf(i)>=0}),!n.length):n}return!1},i.prototype.render=function(){var t=this.el,i=this.options.content;return this.canRender()&&(t.innerHTML=i),this},i.prototype.setupTracking=function(){if(!this.status)return this;if(!this.options.clickTrack)return this;var t=this.el;if(this.options.clickTrack.$el){var i=t.querySelector(this.options.clickTrack.$el);t=i?i:t}return t?(t.addEventListener("touchstart",this.onClick),t.addEventListener("click",this.onClick),this):this},i.prototype.onClick=function(){if(!window.ga||!window.ga.loaded)return this;var t={eventCategory:"Avocado",eventAction:"click"};return this.options.clickTrack.eventCategory&&(t.eventCategory=this.options.clickTrack.eventCategory),this.options.clickTrack.eventAction&&(t.eventAction=this.options.clickTrack.eventAction),this.options.clickTrack.eventLabel&&(t.eventLabel=this.options.clickTrack.eventLabel),window.ga("send","event",t),this};var e=function(){this.version=t,this.links=[],this.targeting={},this.units=[],this.linkPreferred=!1,this.initialize()};e.prototype.initialize=function(){return this.getLinks(),this},e.prototype._parseTargetValues=function(t){return!!t&&(Array.isArray(t)?t:"string"==typeof t?t=t.toLowerCase().split(","):"number"==typeof t&&[].push(t))},e.prototype.defineUnit=function(t){if(!t||"object"!=typeof t)return!1;t.Avocado=this;var e=new i(t);return e&&e.isActive()&&this.units.push(e),e},e.prototype.getLinks=function(){var t=document.querySelectorAll("[data-avocado-link]");return!!t.length&&(t=Array.prototype.slice.call(t),this.links=t.map(function(t){if(t.getAttribute("href"))return t.getAttribute("href")}),this)},e.prototype.hasLinks=function(){return this.links.length},e.prototype.getUnitsActive=function(){return this.units.filter(function(t){return t.status})},e.prototype.getUnitsNotActive=function(){return this.units.filter(function(t){return!t.status})},e.prototype.setLinkPreferred=function(t){return"boolean"==typeof t&&(this.linkPreferred=t),this},e.prototype.setTargeting=function(t,i){var e=this._parseTargetValues(i);return!(!t|!e)&&(t=t.toLowerCase(),this.targeting[t]?this.targeting[t].values=[].concat(this.targeting[t].values,e):this.targeting[t]={key:t,values:e},this.targeting[t])},window.Avocado=new e}();